let currentUrl1=window.location.href,lang="hi",selectedBundles=(lang=-1<currentUrl1.indexOf(".com/en")?"en":-1<currentUrl1.indexOf(".com/mr")?"mr":"hi",[]),serviceablePincodeFlag=!0,blacklistedPincodes=[],highRiskProducts=[],highRiskProductFlag=!1,otpVerifyProducts=[],otpVerifyFlag=!1,baCodOrderUrl="",baCodOrderNumber="",baRazorpayOrderId="",baRazorpayPaymentId="",baRazorpayReferenceId="",baRazorpayOnlineAmount="",baCodAmountFinal="",bharatxTransactionId="",baRecoveryOrder=!0,baRecoveryApplied=!1,baOnlinePaySuccess=!1,baOtpCountdown="",baRecoveryOnlineBtnEnable=!1,productHeader="अपना आर्डर दें",discountHeader="डिस्काउंट कूपन",applyCouponBtn="अप्लाई करें",deliveryAddressHeader="अपना डिलीवरी पता भरें",priceDetailsHeader="ऑर्डर की जानकारी",nameLabel="आपका पूरा नाम",mobileLabel="10 अंकीय फोन नंबर डालें",pincodeLabel="पिनकोड",stateLabel="राज्य",districtLabel="ज़िला",talukaLabel="तहसील",villageLabel="गावं",addressLabel="मकान नंबर, रोड, कॉलोनी",landmarkLabel="लैंडमार्क (उदाहरण: गोपाल मंदिर के पास)",postOfficeLabel="डाकघर (वैकल्पिक)",nameRequiredLabel="नाम",mobileRequiredLabel="मोबाइल नंबर",pincodeRequiredLabel="पिनकोड",pincodeServiceableRequiredLabel="इस पिनकोड पर COD उपलब्ध नहीं है",pincodeNotWhitelistRequiredLabel="pincode पर डिलीवरी अनुपलब्ध",stateRequiredLabel="राज्य",districtRequiredLabel="ज़िला",talukaRequiredLabel="तहसील",villageRequiredLabel="गावं",addressRequiredLabel="मकान नंबर, रोड, कॉलोनी",landmarkRequiredLabel="लैंडमार्क",priceDetailsDiscountLabel="कोड से डिस्काउंट",priceDetailsFreeDeliveryLabel="फ्री डिलीवरी",priceDetailsFreeDeliveryValueLabel="₹0 (फ्री)",priceDetailsTotalAmountLabel="कुल राशि",cashOnDeliveryLabel="कैश ऑन डिलीवरी",placeOrderLabel="कॅश ऑन डिलीवरी (COD)",placeOnlinePaymentOrderLabel="Online पेमेंट से खरीदें",removeIconLabel="हटाए",addIconLabel="जोड़ें +",addedBtnLabel="जोड़ा गया ✓",couponSavedLabel="आपकी बचत हुई",couponWithDiscountLabel="डिस्काउंट कूपन से",couponAppliedLabel="लागू हुआ!",smileyModalDiscountLabel="डिस्काउंट",smileyModalDiscountAppliedLabel="कूपन लागू हुआ",confirmModalTextLabel="क्या आप यह ऑर्डर करना चाहते हैं? डिलीवरी पर आपको ₹### का भुगतान करना होगा।",confirmModalYesLabel="हाँ",confirmModalNoLabel="नहीं",mainPriceAmountLabel="राशि",baSpecialDiscount="🌱 स्पेशल PhonePe डिस्काउंट 🌱",baSpecialOffer="सीमित समय के लिए एक ख़ास ऑफर",baRecoveryOrderNow="अभी आर्डर करें और ###% डिस्काउंट पाएं",baRecoveryOrderBtnLabel="PhonePe पर अभी आर्डर करें",baRecoveryCancelBtnLabel="मुझे डिस्काउंट नहीं चाहिए",baOnlinePaymentLabel="UPI से पेमेंट करें",baOnlinePaymentDiscountLabel="डिस्काउंट पाएं",baOnlinePaymentEmiLabel="EMI से पेमेंट करें",baOnlinePaymentDiscountEmiLabel="(ब्याज-मुक्त किश्तें)",baCodOtpHeaderLabel="कैश ऑन डिलीवरी पर भुगतान करें: ₹###",baCodOtpInstructionsLabel="ऑर्डर कंफर्म करने के लिए कृपया OTP दर्ज करें +91-### पर भेजा गया",baCodOtpEnterLabel="OTP दर्ज करें",baCodOtpResendLabel="पुन: OTP भेजें",baCodOtpSubmitLabel="OTP सबमिट करके ऑर्डर प्लेस करें",baCodOtpCancelLabel="ऑर्डर कैंसिल करें",baCodOtpFooterLabel="*इस ऑर्डर की पुष्टि के लिए भारतअ‍ॅग्री से कॉल किया जाएगा।",baCodOtpInvalidLabel="अमान्य OTP",baCodLocateMeLabel="मेरी लोकेशन ढूंढे",baCheckoutType="cod",baDisplayABTPrePaidSeconds="",baDisplayABTPrePaidProducts=["8054115533043"];function setBaItems(e="cod"){var t=JSON.parse(localStorage.getItem("baUpdateCartResponse")).items,e=(baCheckoutType=e,Date.now()),e=(baDisplayABTPrePaidSeconds=e%100,baCodOrderUrl="",baCodOrderNumber="",baOnlinePaySuccess=!1,baRazorpayOrderId="",baRazorpayPaymentId="",baRazorpayReferenceId="",bharatxTransactionId="",baOtpCountdown="",document.getElementsByClassName("quantity__input")[0].value);sendBaFbEvents("AddToCart",{currency:"INR",value:Number(t[0].final_line_price)/100,num_items:Number(e)}),sendBaFbEvents("InitiateCheckout",{currency:"INR",value:Number(t[0].final_line_price)/100,num_items:Number(e)}),document.getElementById("product-count-id").innerHTML=t.length;for(let e=0;e<t.length;e++){replaceChildrenAlternative2(document.getElementById("product-info-div")),document.getElementById("ba-product-info-div-loader").style.display="none";var a=document.createElement("div"),n=(document.getElementById("product-info-div").appendChild(a),document.createElement("div")),a=(n.className="row align-items-center",a.appendChild(n),document.createElement("div")),d=(a.className="col-3 pr-0",a.style.position="relative",n.appendChild(a),document.createElement("img")),d=(d.className="ba-cod-product-img",d.src=t[e].image,d.alt="product image",d.width=60,d.height=60,a.appendChild(d),document.createElement("div")),a=(d.className="ba-cod-product-img-quantity",d.id="ba-cod-main-product-quantity"+e,d.innerHTML=document.getElementsByClassName("quantity__input")[0].value,a.appendChild(d),document.createElement("div")),d=(a.className="col-6 pr-0 pl-0",n.appendChild(a),document.createElement("div")),o=(d.className="ba-cod-product-title",t[e]&&t[e].product_title?t[e].product_title:""),o=(d.innerHTML=50<o.length?o.slice(0,50)+"..":o,a.appendChild(d),document.createElement("div")),d=(o.className="ba-cod-variant-info",t[e]&&t[e].variant_title?t[e].variant_title:""),d=(o.innerHTML=25<d.length?d.slice(0,25)+"..":d,a.appendChild(o),document.createElement("div")),a=(d.className="col-3 pl-0",d.style.paddingRight="16px",n.appendChild(d),document.createElement("div")),o=(d.appendChild(a),document.createElement("span")),n=(o.className="ba-cod-selling-price",o.id="ba-cod-main-product-price"+e,o.innerHTML=t[e]&&t[e].final_line_price?"₹ "+Number(t[e].final_line_price)/100:"₹ 0",a.appendChild(o),document.createElement("div")),d=(n.className="d-flex justify-content-start",n.style.marginLeft="78px",document.getElementById("product-info-div").appendChild(n),document.createElement("div")),a=(d.className="ba-cod-quantity-div",n.appendChild(d),document.createElement("span")),o=(a.className="ba-cod-quantity-symbols ba-cod-minus-symbol",a.innerHTML="➖",a.addEventListener("click",function(){decrementQuantity()}),d.appendChild(a),document.createElement("input")),n=(o.className="ba-cod-quantity-number",o.type="number",o.id="ba-cod-quantity",o.value=document.getElementsByClassName("quantity__input")[0].value,o.min="1",o.max="10",o.disabled=!0,d.appendChild(o),document.createElement("span"));n.className="ba-cod-quantity-symbols ba-cod-plus-symbol",n.innerHTML="➕",n.addEventListener("click",function(){incrementQuantity()}),d.appendChild(n)}loadBaProductBundles(),resetPlaceOrderButton(),resetCodFormFields(),resetCodFooter(),resetCodConfirmationModal(),checkCodEligibility(baCheckoutType),populatePriceDetailsCard(),loadCouponCodes(!0),checkFreeDelivery(),sendBaCodGEvents("ba_cod_order_begin_checkout",{productId:t[0].id}),triggerBaCodConversionEvents(),document.getElementById("baCodTriggerRecovery").disabled=!1,baRecoveryApplied&&applyBaRecoveryDiscount(!1),blacklistedPincodes&&0!==blacklistedPincodes.length||loadBlackListedPincodes(),checkHighRiskAndOTPVerifyOrder(),autoFillUserDetails()}function clearCartEmbed(){fetch("/cart/clear.js",{method:"GET",redirect:"follow"}).then(e=>{200===e.status&&addCartDetailsEmbed()}).catch(e=>{})}function addCartDetailsEmbed(){var e=JSON.parse(localStorage.getItem("baCodCartStorage")),e=(e&&0<e.length&&fetch("/cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:e})}).then(e=>e.json()).then(e=>{var t=document.getElementById("ba-cart-icon-value");t&&(t.innerHTML=e&&e.items?e.items.length:0)}),localStorage.removeItem("baCodCartStorage"),localStorage.removeItem("baUpdateCartResponse"),document.getElementById("product-info-div")),e=(replaceChildrenAlternative2(e),document.getElementById("ba-product-info-div-loader").style.display="block",document.getElementById("ba-cod-price-details-div").style.display="none",document.getElementById("ba-cod-discount-div")),t=document.getElementById("ba-active-coupon"),e=(replaceChildrenAlternative2(e),e.appendChild(t),document.getElementById("ba-cod-bundle-cards-div")),t=(replaceChildrenAlternative2(e),document.getElementById("ba-cod-discount-loader").style.display="none",localStorage.removeItem("BA_COD_Coupon_code"),previousCouponCode="",document.getElementById("ba-active-coupon"));t&&(t.style.display="none"),document.getElementById("product-count-id").innerHTML="",document.getElementById("baCodTriggerRecovery").disabled=!0,resetCodFooter(),resetCodFormFields(),resetPlaceOrderButton(),selectedBundles=[],serviceablePincodeFlag=!0}function loadBaProductBundles(){selectedBundles=[];var e=JSON.parse(localStorage.getItem("baUpdateCartResponse")).items[0].id,t=getBaCodProductData();t.variant_bundles&&t.variant_bundles[e]&&0<t.variant_bundles[e].length?setBaProductBundles(t.variant_bundles[e]):document.getElementById("ba-cod-bundle-div").style.display="none"}function setBaProductBundles(o){var l=document.getElementById("ba-cod-bundle-cards-div");replaceChildrenAlternative2(l),o&&0!==o.length?(o=o.sort((e,t)=>t.priority_index-e.priority_index),document.getElementById("ba-cod-bundle-div").style.display="block"):(o=[],document.getElementById("ba-cod-bundle-div").style.display="none");for(let d=0;d<o.length;d++){var i=o[d]&&o[d].secondary_product&&o[d].secondary_product.product,r=i&&i.title,c=i&&i.variant_title,s=i&&i.selling_price,u=o[d]&&o[d].price;let e,t=(void 0!==s&&void 0!==u&&(e=Math.floor((s-u)/s*100)),void 0!==s&&void 0!==u&&0,"https://shopify-krushidukan.leanagri.com/ba-cod-form-images/product-img-placeholder.png");i&&i.images&&i.images[0]&&i.images[0].media_url&&(t=i.images[0].media_url);var s=document.createElement("div"),i=(s.id="baBundleCard"+o[d].id,1===o.length&&(s.className="p-3 ba-cod-bundle-card ba-cod-bundle-card-full-width mr-3"),1<o.length&&(s.className="p-3 ba-cod-bundle-card ba-cod-bundle-card-half-width mr-3"),l.appendChild(s),document.createElement("div")),m=(i.className="row align-items-center h-100 mb-2",s.appendChild(i),document.createElement("div")),b=(m.className="col-auto pr-1",i.appendChild(m),document.createElement("input")),m=(b.className="ba-cod-bundle-select-box",b.type="checkbox",b.id="baBundleCardSelect"+d,m.appendChild(b),document.createElement("div"));m.className="col-7 pl-0",i.appendChild(m);let a="";a=o[d]&&o[d].title?o[d].title:(r||"")+" "+(c||"")+" - "+(u?"₹ "+u:"0");b=document.createElement("div"),c=(b.className="ba-cod-bundle-title",b.innerHTML=a,0<e&&o[d]&&!o[d].title&&((r=document.createElement("span")).className="ba-cod-bundle-discount ml-2",r.innerHTML=`(${e}% off)`,b.appendChild(r)),m.appendChild(b),document.createElement("div")),u=(c.className="ba-cod-bundle-description",c.innerHTML=o[d]&&o[d].desc?o[d].desc:"",m.appendChild(c),document.createElement("div")),r=(u.className="col-3 pl-0 pr-1",i.appendChild(u),document.createElement("img"));r.alt="product image",r.src=t,r.style.borderRadius="6px",r.width=60,r.height=60,u.appendChild(r),s.addEventListener("click",function(){var e=document.getElementById("baBundleCardSelect"+d);e.checked?(e.checked=!1,onBaProductBundleRemoveClick(o[d].id)):(e.checked=!0,onBaProductBundleClick(o[d],d))});let n=document.getElementById("baBundleCardSelect"+d);n.addEventListener("click",function(){n.checked=!n.checked})}}function onBaProductBundleClick(e,t){var a=JSON.parse(JSON.stringify(e)),a=(sendBaCodGEvents("BA_bundle_cart_added",{from_frag:currentUrl1,product_title:e&&e.secondary_product&&e.secondary_product.product?e.secondary_product.product.title:void 0,productId:e&&e.secondary_product?e.secondary_product.shopify_id:void 0,variantId:e&&e.secondary_product?e.secondary_product.variant_id:void 0,selling_price:e?e.price:void 0}),a.selected=!0,selectedBundles.push(a),Number(document.getElementById("product-count-id").innerHTML)),a=(document.getElementById("product-count-id").innerHTML=String(a+1),selectedBundles.length-1),n=e&&e.secondary_product&&e.secondary_product.product?e.secondary_product.product.title:void 0,e=e?e.price:void 0,d=document.getElementById("ba-cod-price-details-bundle-items"),o=document.createElement("div"),a=(o.className="row mt-2 pb-2 align-items-center ba-cod-price-details-items",o.id="bundlePriceRow"+a,d.appendChild(o),document.createElement("div")),d=(a.className="col-7 ba-cod-price-details-product-title",a.innerHTML=n&&34<n.length?n.slice(0,34)+"..":null!=n?n:"",o.appendChild(a),document.createElement("div"));d.className="col-5 text-right pl-0 ba-cod-price-details-product-price",d.innerHTML=e?"₹ "+e:"0",o.appendChild(d);let l=document.getElementById("ba-price-details-total-value").innerHTML;l=l&&l.replace("₹ ",""),l=Number(l)+e,l=Number(l).toFixed(2),document.getElementById("ba-price-details-total-value").innerHTML="₹ "+l,document.getElementById("ba-cod-footer-total-amount").innerHTML="₹ "+l,updateOnlinePaymentPrice(l)}function onBaProductBundleRemoveClick(t){let a;for(let e=0;e<selectedBundles.length;e++)selectedBundles[e].id===t&&(a=e);sendBaCodGEvents("BA_bundle_cart_removal",{from_frag:currentUrl1,product_title:selectedBundles[a]&&selectedBundles[a].secondary_product&&selectedBundles[a].secondary_product.product?selectedBundles[a].secondary_product.product.title:void 0,productId:selectedBundles[a]&&selectedBundles[a].secondary_product?selectedBundles[a].secondary_product.shopify_id:void 0,variantId:selectedBundles[a]&&selectedBundles[a].secondary_product?selectedBundles[a].secondary_product.variant_id:void 0,selling_price:selectedBundles[a].price}),selectedBundles[a].selected=!1;var e=Number(document.getElementById("product-count-id").innerHTML);document.getElementById("product-count-id").innerHTML=String(e-1),document.getElementById("bundlePriceRow"+a).style.display="none";let n=document.getElementById("ba-price-details-total-value").innerHTML;n=n&&n.replace("₹ ",""),n=Number(n)-selectedBundles[a].price,n=Number(n).toFixed(2),document.getElementById("ba-price-details-total-value").innerHTML="₹ "+n,document.getElementById("ba-cod-footer-total-amount").innerHTML="₹ "+n,updateOnlinePaymentPrice(n)}function getBundlesTotalPrice(){let t=0;if(selectedBundles)for(let e=0;e<selectedBundles.length;e++)selectedBundles[e].enabled&&selectedBundles[e].selected&&(t+=selectedBundles[e].price);return t}function getBundlesActualTotalPriceWithoutDiscount(){let t=0;if(selectedBundles)for(let e=0;e<selectedBundles.length;e++)selectedBundles[e].enabled&&selectedBundles[e].selected&&(t+=selectedBundles[e].secondary_product.product.selling_price);return t}function loadCouponCodes(e){var t=JSON.parse(localStorage.getItem("baCodCoupons"))||[];0<t.length?setDiscountCoupons(t,e):document.getElementById("ba-discount-coupon-div").style.display="none"}function setDiscountCoupons(n,e){var d=document.getElementById("ba-cod-discount-div"),t=document.getElementById("ba-active-coupon"),t=(replaceChildrenAlternative2(d),d.appendChild(t),document.getElementById("ba-discount-coupon-div-loader").style.display="none",JSON.parse(localStorage.getItem("baUpdateCartResponse"))),o=Number(t.total_price/100);let l=[];var i=getBaCartMainItemDetails();for(let a=0;a<n.length;a++){let e="";n[a].excluded_variant_ids&&(e=n[a].excluded_variant_ids);var r=new Date;r.setHours(0,0,0);let t=null;((t="None"!==n[a].ends_at?new Date(n[a].ends_at):t)>=r||null===t)&&o>n[a].min_amount_rule&&-1===e.indexOf(i.id.toString())&&l.push(n[a]),-1<e.indexOf(i.id.toString())&&(baRecoveryOrder=!1)}0===l.length?document.getElementById("ba-discount-coupon-div").style.display="none":(l=l.sort((e,t)=>t.priority_index-e.priority_index),document.getElementById("ba-discount-coupon-div").style.display="block");for(let a=0;a<l.length;a++){let e="",t="";t="en"===lang?(e=l[a].coupon_title_en,l[a].coupon_sub_title_en):"mr"===lang?(e=l[a].coupon_title_mr,l[a].coupon_sub_title_mr):(e=l[a].coupon_title_hi,l[a].coupon_sub_title_hi);var c=document.createElement("div"),s=(c.id=l[a].title,c.className="col-auto p-3 ba-cod-discount-card mr-2",d.appendChild(c),document.createElement("div")),u=(s.className="ba-cod-discount-title",c.appendChild(s),document.createElement("span")),u=(u.className="ba-cod-discount-title1 mr-3",u.innerHTML=e,s.appendChild(u),document.createElement("span")),s=(u.className="ba-cod-discount-title2",u.innerHTML=t,s.appendChild(u),document.createElement("div")),u=(s.className="row m-1 align-items-center justify-content-between",c.appendChild(s),document.createElement("div")),u=(u.className="col-auto ba-cod-discount-coupon",u.innerHTML=l[a].title,s.appendChild(u),document.createElement("div"));u.className="col-auto ba-cod-discount-apply-btn",u.innerHTML=applyCouponBtn,s.appendChild(u),c.addEventListener("click",function(){applyCouponCodes(l[a].title,l[a],!0)})}baRecoveryApplied||(0<l.length?applyCouponCodes(l[0].title,l[0],!1,e):(document.getElementById("ba-price-details-discount-value").innerHTML="0",document.getElementById("ba-price-details-discount-row").style.display="none",localStorage.removeItem("BA_COD_Coupon_code")))}"en"===lang&&(productHeader="Place your order",discountHeader="Discount Coupon",applyCouponBtn="Apply",deliveryAddressHeader="Fill your delivery address",priceDetailsHeader="Price Details",nameLabel="Your Full Name",mobileLabel="Enter 10-digit phone number",pincodeLabel="Pincode",stateLabel="State",districtLabel="District",talukaLabel="Taluka",villageLabel="Village",addressLabel="House Number, Road, Colony",landmarkLabel="Landmark (Example: Near Gopal Mandir)",postOfficeLabel="Post Office (Optional)",nameRequiredLabel="Enter Name",mobileRequiredLabel="Enter Mobile Number",pincodeRequiredLabel="Enter Pincode",pincodeServiceableRequiredLabel="COD is not available on this pincode",pincodeNotWhitelistRequiredLabel="Not serviceable at pincode",stateRequiredLabel="Enter State",districtRequiredLabel="Enter District",talukaRequiredLabel="Enter Taluka",villageRequiredLabel="Enter Village",addressRequiredLabel="Enter Address",landmarkRequiredLabel="Enter Landmark",priceDetailsDiscountLabel="Coupon Code Discount",priceDetailsFreeDeliveryLabel="FREE Delivery",priceDetailsFreeDeliveryValueLabel="₹0 (FREE)",priceDetailsTotalAmountLabel="Total Amount",cashOnDeliveryLabel="Cash On Delivery",placeOrderLabel="Cash on Delivery (COD)",placeOnlinePaymentOrderLabel="Online payment",removeIconLabel="Remove",addIconLabel="Add +",addedBtnLabel="Added ✓",couponSavedLabel="Saved",couponWithDiscountLabel="with discount Coupon",couponAppliedLabel="Applied!",smileyModalDiscountLabel="Discount",smileyModalDiscountAppliedLabel="Coupon Applied",confirmModalTextLabel="क्या आप यह ऑर्डर करना चाहते हैं? डिलीवरी पर आपको ₹### का भुगतान करना होगा।",confirmModalYesLabel="Yes",confirmModalNoLabel="No",mainPriceAmountLabel="Amount",baSpecialDiscount="🌱 Special PhonePe Discount 🌱",baSpecialOffer="Special offer for a limited time",baRecoveryOrderNow="Order now and get ###% discount",baRecoveryOrderBtnLabel="Order with PhonePe Now",baRecoveryCancelBtnLabel="I don't want a discount",baOnlinePaymentLabel="Pay via UPI ",baOnlinePaymentDiscountLabel="Discount",baOnlinePaymentEmiLabel="Pay via EMI",baOnlinePaymentDiscountEmiLabel="(No Interest EMI)",baCodOtpHeaderLabel="Pay Cash on Delivery : ₹###",baCodOtpEnterLabel="Enter OTP",baCodOtpInstructionsLabel="To Confirm this order please enter the OTP sent to +91-###",baCodOtpResendLabel="Resend OTP",baCodOtpSubmitLabel="Submit OTP & Place Order",baCodOtpCancelLabel="Cancel Order",baCodOtpFooterLabel="*You will receive a call from BharatAgri to confirm this order.",baCodOtpInvalidLabel="Invalid OTP",baCodLocateMeLabel="Find my Location"),"mr"===lang&&(productHeader="आपला ऑर्डर करा",discountHeader="डिस्काउंट कूपन",applyCouponBtn="लागू करा",deliveryAddressHeader="डिलिव्हरी पत्ता",priceDetailsHeader="ऑर्डरची माहिती",nameLabel="तुमचे पुर्ण नाव",mobileLabel="10 अंकी फोन नंबर प्रविष्ट करा",pincodeLabel="पिनकोड",stateLabel="राज्य",districtLabel="ज़िला",talukaLabel="तहसील",villageLabel="गावं",addressLabel="घर क्रमांक, रस्ता, कॉलनी",landmarkLabel="लैंडमार्क (उदाहरण: गोपाळ मंदिराजवळ)",postOfficeLabel="पोस्ट ऑफिस (पर्यायी)",nameRequiredLabel="नाव",mobileRequiredLabel="मोबाइल नंबर",pincodeRequiredLabel="पिनकोड",pincodeServiceableRequiredLabel="या पिनकोडवर COD उपलब्ध नाही",pincodeNotWhitelistRequiredLabel="डिलिव्हरी pincode वर उपलब्ध नाही",stateRequiredLabel="राज्य",districtRequiredLabel="ज़िला",talukaRequiredLabel="तहसील",villageRequiredLabel="गाव",addressRequiredLabel="घर क्रमांक, रस्ता, कॉलनी",landmarkRequiredLabel="जवळची खूण",priceDetailsDiscountLabel="कूपन कोड सवलत",priceDetailsFreeDeliveryLabel="फ्री डिलीवरी",priceDetailsFreeDeliveryValueLabel="₹0 (फ्री)",priceDetailsTotalAmountLabel="एकूण रक्कम",cashOnDeliveryLabel="कैश ऑन डिलिव्हरी",placeOrderLabel="कॅश ऑन डिलिव्हरी (COD)",placeOnlinePaymentOrderLabel="Online पेमेंट से खरीदें",removeIconLabel="हटाए",addIconLabel="जोड़ें +",addedBtnLabel="जोड़ा गया ✓",couponSavedLabel="तुमची बचत झाली",couponWithDiscountLabel="अधिक सूट मिळाली",couponAppliedLabel="लागू झाला!",smileyModalDiscountLabel="डिस्काउंट",smileyModalDiscountAppliedLabel="कूपन लागू हुआ",confirmModalTextLabel="क्या आप यह ऑर्डर करना चाहते हैं? डिलीवरी पर आपको ₹### का भुगतान करना होगा।",confirmModalYesLabel="होय",confirmModalNoLabel="नाही",mainPriceAmountLabel="रक्कम",baSpecialDiscount="🌱 स्पेशल PhonePe डिस्काउंट 🌱",baSpecialOffer="सीमित समय के लिए एक ख़ास ऑफर",baRecoveryOrderNow="अभी आर्डर करें और ###% डिस्काउंट पाएं",baRecoveryOrderBtnLabel="PhonePe पर अभी आर्डर करें",baRecoveryCancelBtnLabel="मुझे डिस्काउंट नहीं चाहिए",baOnlinePaymentLabel="UPI से पेमेंट करें",baOnlinePaymentDiscountLabel="चा डिस्काउंट",baOnlinePaymentEmiLabel="EMI से पेमेंट करें",baOnlinePaymentDiscountEmiLabel="(ब्याज-मुक्त किश्तें)",baCodOtpHeaderLabel="कैश ऑन डिलीवरी पर भुगतान करें: ₹###",baCodOtpInstructionsLabel="ऑर्डर कंफर्म करने के लिए कृपया OTP दर्ज करें +91-### पर भेजा गया",baCodOtpEnterLabel="OTP दर्ज करें",baCodOtpResendLabel="पुन: OTP भेजें",baCodOtpSubmitLabel="OTP सबमिट करके ऑर्डर प्लेस करें",baCodOtpCancelLabel="ऑर्डर कैंसिल करें",baCodOtpFooterLabel="*इस ऑर्डर की पुष्टि के लिए भारतअ‍ॅग्री से कॉल किया जाएगा।",baCodOtpInvalidLabel="अमान्य OTP",baCodLocateMeLabel="मेरी लोकेशन ढूंढे"),document.getElementById("product-header-id").innerHTML=productHeader,document.getElementById("discount-header-id").innerHTML=discountHeader,document.getElementById("delivery-address-header-id").innerHTML=deliveryAddressHeader,document.getElementById("ba-cod-price-header-id").innerHTML=priceDetailsHeader,document.getElementById("ba-cod-footer-place-order").innerHTML=placeOrderLabel,document.getElementById("ba-cod-footer-delivery-label").innerHTML=cashOnDeliveryLabel,document.getElementById("farmerName").placeholder=nameLabel,document.getElementById("farmerNameRequired").innerHTML=nameRequiredLabel,document.getElementById("farmerMobile").placeholder=mobileLabel,document.getElementById("farmerMobileRequired").innerHTML=mobileRequiredLabel,document.getElementById("baCodPincode").placeholder=pincodeLabel,document.getElementById("baCodPincodeRequired").innerHTML=pincodeRequiredLabel,document.getElementById("baCodPincodeServiceableRequired").innerHTML=pincodeServiceableRequiredLabel,document.getElementById("baCodPincodeNotWhitelistRequired").innerHTML=pincodeNotWhitelistRequiredLabel,document.getElementById("talukaName").placeholder=talukaRequiredLabel,document.getElementById("talukaNameRequired").innerHTML=talukaRequiredLabel,document.getElementById("villageName").placeholder=villageLabel,document.getElementById("villageNameRequired").innerHTML=villageRequiredLabel,document.getElementById("baAddress").placeholder=addressLabel,document.getElementById("baAddressRequired").innerHTML=addressRequiredLabel,document.getElementById("baLandmark").placeholder=landmarkLabel,document.getElementById("baLandmarkRequired").innerHTML=landmarkRequiredLabel,document.getElementById("baPostOffice").placeholder=postOfficeLabel,document.getElementById("baCodDistrictSelect").placeholder=districtRequiredLabel,document.getElementById("baCodDistrictSelectRequired").innerHTML=districtRequiredLabel,document.getElementById("baCodStateSelectRequired").innerHTML=stateRequiredLabel,document.getElementById("ba-cod-confirm-txt-div").innerHTML=confirmModalTextLabel,document.getElementById("ba-cod-confirm-yes-btn-label").innerHTML=confirmModalYesLabel,document.getElementById("ba-cod-confirm-no-btn-label").innerHTML=confirmModalNoLabel,document.getElementById("baSpecialDiscount").innerHTML=baSpecialDiscount,document.getElementById("baSpecialOffer").innerHTML=baSpecialOffer,document.getElementById("baRecoveryOrderBtnLabel").innerHTML=baRecoveryOrderBtnLabel,document.getElementById("baRecoveryCancelBtnLabel").innerHTML=baRecoveryCancelBtnLabel,document.getElementById("baCodFooterOnlineLabel").innerHTML=baOnlinePaymentLabel,document.getElementById("baCodFooterOnlineEmiLabel").innerHTML=baOnlinePaymentEmiLabel,document.getElementById("ba-cod-otp-header").innerHTML=baCodOtpHeaderLabel,document.getElementById("ba-cod-otp-instructions").innerHTML=baCodOtpInstructionsLabel,document.getElementById("baCodEnterOTP").innerHTML=baCodOtpEnterLabel,document.getElementById("baCodResendOtpBtn").innerHTML=baCodOtpResendLabel,document.getElementById("baCodOtpSubmitBtnLabel").innerHTML=baCodOtpSubmitLabel,document.getElementById("baCodOtpCancelBtn").innerHTML=baCodOtpCancelLabel,document.getElementById("baCodOtpFooter").innerHTML=baCodOtpFooterLabel,document.getElementById("baCodOtpInvalid").innerHTML=baCodOtpInvalidLabel,document.getElementById("baCodDistrictSelectLabel").innerHTML=districtLabel,document.getElementById("baCodLocateMeLabel").innerHTML=baCodLocateMeLabel,document.getElementById("baCreditBanner").src=`https://shopify-krushidukan.leanagri.com/ba-cod-form-images/ba_credit_${lang}.webp`;let previousCouponCode="";function applyCouponCodes(e,t,a,n){document.getElementById("ba-cod-discount-loader").style.display="block",previousCouponCode=previousCouponCode||e;var d=JSON.parse(localStorage.getItem("baUpdateCartResponse")),o=(document.getElementById("ba-price-details-discount-value").innerHTML="0",document.getElementById("ba-price-details-discount-row").style.display="none",getBundlesTotalPrice()),l=Number(d.total_price/100),d=Number(d.total_price/100),l=(d+=o,sendBaCodGEvents("BA_cart_cc_clk",{from_frag:currentUrl1,discount_coupon:e,order_value:l}),document.getElementById("ba-price-details-total-value").innerHTML="₹ "+d.toFixed(2),document.getElementById("ba-cod-footer-total-amount").innerHTML="₹ "+d.toFixed(2),updateOnlinePaymentPrice(d.toFixed(2)),previousCouponCode&&(o=document.getElementById(previousCouponCode))&&(o.style.display="block"),document.getElementById("ba-active-coupon")),d=(l&&(l.style.display="none"),document.getElementById(e).style.display="none",document.getElementById("ba-active-coupon").style.display="block",getBaCartMainItemDetails());let i=0;t.value_type&&"percentage"===t.value_type?(o=Math.abs(t.value)/100,i=((i=Number(d.final_line_price)/100)*o).toFixed(2).toString(),Number(i)>Number(t.max_discount_rule)&&(i=t.max_discount_rule.toString())):t.value_type&&(i=Number(d.final_line_price)/100,l=Math.abs(t.value),i=(i=(i-l).toFixed(2)).toString());o=getBundlesTotalPrice(),t=(t=Number(d.final_line_price)/100)+o-i;t=Number(t),document.getElementById("ba-price-details-discount-value").innerHTML="-₹ "+i.replace(".00",""),document.getElementById("ba-price-details-discount-row").style.display="flex",document.getElementById("ba-price-details-total-value").innerHTML="₹ "+t.toFixed(2),document.getElementById("ba-cod-footer-total-amount").innerHTML="₹ "+t.toFixed(2),updateOnlinePaymentPrice(t.toFixed(2)),document.getElementById("ba-cod-saved-amount").innerHTML=couponSavedLabel+" ₹"+i.replace(".00",""),document.getElementById("ba-cod-saved-amount-line2").innerHTML=couponWithDiscountLabel,document.getElementById("ba-cod-applied-coupon-content").innerHTML=e+" "+couponAppliedLabel,previousCouponCode=e,document.getElementById("ba-cod-discount-loader").style.display="none",a&&document.getElementById("ba-active-coupon").scrollIntoView({behavior:"smooth"}),localStorage.setItem("BA_COD_Coupon_code","BA_"+e),baRecoveryApplied=!1}let stateId="",districtId="",talukaId="",villageId="",stateName="",districtName="",talukaName="",villageName="",stateNameEn="",districtNameEn="",talukaNameEn="",villageNameEn="",numericalNumberRegex=/^[0-9]+$/,stateList=[];function setStates(){var t=document.getElementById("baCodStateSelect"),e=(t.addEventListener("change",function(){onSelectBoxStateChange(this)}),document.getElementById("baCodStateSelectLabel"));replaceChildrenAlternative2(t),e.innerHTML=stateLabel,t.add(e);for(let e=0;e<stateList.length;e++){var a=stateList[e].name_en,n=document.createElement("option");n.innerHTML=a,n.value=stateList[e].id,t.add(n)}}function loadDistricts(e,t="",a=""){document.getElementById("ba-cod-district-loader").style.display="inline-block";fetch(`https://api-cache.leanagri.com/location/district_list/en/${e}/district_list.json`,{method:"GET",redirect:"follow"}).then(e=>{200===e.status?e.json().then(e=>{document.getElementById("ba-cod-district-loader").style.display="none",setDistricts(e.data,t,a)}):document.getElementById("ba-cod-district-loader").style.display="none"}).catch(e=>{document.getElementById("ba-cod-district-loader").style.display="none"})}function setDistricts(t,a="",e){let n="";var d=document.getElementById("baCodDistrictSelect"),o=(d.removeEventListener("change",onSelectBoxDistrictChange),d.addEventListener("change",function(){onSelectBoxDistrictChange(this)}),document.createElement("option")),l=(o.innerHTML="Select District",o.value="",replaceChildrenAlternative2(d),d.add(o),[]);for(let e=0;e<t.length;e++){a&&Number(a)===Number(t[e].id)&&(n=t[e].id);var i,r=t[e].name_en;-1===l.indexOf(r.toLowerCase())&&((i=document.createElement("option")).innerHTML=r,i.value=t[e].id,d.add(i),l.push(r.toLowerCase()))}a&&n?d.value=a:(d.value="",districtId="")}function loadTalukas(e,t=0,a=""){fetch(`https://api-cache.leanagri.com/location/taluka_list/en/${e}/taluka_list.json`,{method:"GET",redirect:"follow"}).then(e=>{200===e.status?e.json().then(e=>{setBaAssistDropdownOptions(e.data,"baCodTalukaDropdown","talukaName",a)}):setBaAssistDropdownOptions([],"baCodTalukaDropdown","talukaName",a)}).catch(e=>{setBaAssistDropdownOptions([],"baCodTalukaDropdown","talukaName",a)})}function loadVillages(e,t=0,a=""){fetch(`https://api-cache.leanagri.com/location/village_list/en/${e}/village_list.json`,{method:"GET",redirect:"follow"}).then(e=>{200===e.status?e.json().then(e=>{setBaAssistDropdownOptions(e.data,"baCodVillageDropdown","villageName",a)}):setBaAssistDropdownOptions([],"baCodVillageDropdown","villageName",a)}).catch(e=>{setBaAssistDropdownOptions([],"baCodVillageDropdown","villageName",a)})}function createOrderObject(e){sendBaCodGEvents("ba_cod_order_submit_click",{}),document.getElementById("ba-cod-create-order-button").disabled=!0,document.getElementById("ba-cod-create-order-online-button").disabled=!0,document.getElementById("ba-cod-create-order-online-emi-button").disabled=!0;var t=document.getElementById("farmerName"),a=document.getElementById("farmerMobile"),n=document.getElementById("baCodPincode"),d=document.getElementById("baCodStateSelect"),o=document.getElementById("baCodDistrictSelect"),l=(stateNameEn,districtNameEn,document.getElementById("talukaName")),i=document.getElementById("villageName"),r=document.getElementById("baAddress"),c=document.getElementById("baLandmark");document.getElementById("baPostOffice");t.value=getFormattedAndRightValues(t.value),r.value=getFormattedAndRightValues(r.value),c.value=getFormattedAndRightValues(c.value),l.value=getFormattedAndRightValues(l.value),i.value=getFormattedAndRightValues(i.value);let s=!1,u=!1;resetFormFieldsValidation(),(!t.value||t.value.length<3)&&(t.classList.add("ba-mandatory-field-border"),document.getElementById("farmerNameRequired").style.display="block",u=s=!0,baScrollToId("farmerName")),a&&a.value&&10===a.value.length&&a.value.match(numericalNumberRegex)||(a.classList.add("ba-mandatory-field-border"),document.getElementById("farmerMobileRequired").style.display="block",s||baScrollToId("farmerMobile"),u=s=!0,a.value&&sendBaCodGEvents("ba_cod_order_validate_error_mobile",{mobile:a.value})),(!r.value||r.value.length<3)&&(r.classList.add("ba-mandatory-field-border"),document.getElementById("baAddressRequired").style.display="block",s||baScrollToId("baAddress"),u=s=!0),stateId||(d.classList.add("ba-mandatory-field-border"),document.getElementById("baCodStateSelectRequired").style.display="block",s||baScrollToId("baCodStateSelect"),u=s=!0),districtId||(o.classList.add("ba-mandatory-field-border"),document.getElementById("baCodDistrictSelectRequired").style.display="block",s||baScrollToId("baCodDistrictSelect"),u=s=!0),l.value||(l.classList.add("ba-mandatory-field-border"),document.getElementById("talukaNameRequired").style.display="block",s||baScrollToId("talukaName"),u=s=!0),i.value||(i.classList.add("ba-mandatory-field-border"),document.getElementById("villageNameRequired").style.display="block",s||baScrollToId("villageName"),u=s=!0),n&&n.value&&6===n.value.length&&n.value.match(numericalNumberRegex)&&"0"!==n.value[0]?!(0<getWhitelistedPincodes().length)||validateWhiteListedPincode(n.value)?-1<String(blacklistedPincodes).indexOf(n.value)&&(displayPincodeError(n),s||baScrollToId("baCodPincode"),s=!0):(n.classList.add("ba-mandatory-field-border"),document.getElementById("baCodPincodeNotWhitelistRequired").style.display="block",sendBaCodGEvents("ba_cod_pincode_error",{pincode:n.value}),s||baScrollToId("baCodPincode"),u=s=!0):(n.classList.add("ba-mandatory-field-border"),document.getElementById("baCodPincodeRequired").style.display="block",s||baScrollToId("baCodPincode"),u=s=!0),s&&u?baFormValidationErrorRest():(sendBaCodGEvents("ba_cod_order_creation",{mobile:a.value}),c=getBaOrderObject(),document.getElementById("baCodTriggerRecovery").disabled=!0,r=getLineItemsObject(),d=getBaTotalOrderAmount(),"cod"!==e||s?"online"!==e||u?"emi"!==e||u?baFormValidationErrorRest():(sendBaCodGEvents("ba_cod_order_submit_emi_pay",{}),document.getElementById("ba-cod-footer-online-btn-emi-loader").style.display="inline-block",document.getElementById("ba-cod-footer-online-emi-amount").style.display="none",(o=getOnlineEmiPaymentPrice())&&1<Number(o)?generateBaBharatxOrder(a.value,o,t.value):resetCodFooter()):(sendBaCodGEvents("ba_cod_order_submit_online_pay",{}),document.getElementById("ba-cod-footer-online-btn-loader").style.display="inline-block",document.getElementById("ba-cod-footer-online-amount").style.display="none",(l=getOnlinePaymentPrice())&&1<Number(l)?generateBaRazorpayOrder(a.value,l,t.value):resetCodFooter()):(sendBaCodGEvents("ba_cod_order_submit_cod",{}),document.getElementById("ba-cod-footer-apply-btn-loader").style.display="inline-block",document.getElementById("ba-cod-footer-total-amount").style.display="none",baCreateOrderApi(c,d,r,a.value,e)))}function baCreateOrderApi(e,t,a,n,d){"online"===d&&sendBaCodGEvents("ba_payment_success_order_creation",{}),"emi"===d&&sendBaCodGEvents("ba_payment_emi_success_order_creation",{}),localStorage.setItem("baProcessOrder",JSON.stringify({baO2:e,createOrderTotalValue:t,createOrderLineItems:a,mobileValue:n,type:d}));let o=!1;(o="cod"===d?checkBaCodOrderCount():o)&&sendBaCodGEvents("ba_multiple_cod_otp_triggered",{value:n.toString()}),otpVerifyFlag&&"cod"===d&&sendBaCodGEvents("ba_otp_verify_modal_triggered",{value:n.toString()}),(highRiskProductFlag||otpVerifyFlag||o)&&"cod"===d?displayConfirmationModal(o):baProcessOrder(e,t,a,n,d)}function getBaCodCurrentTime(){return(new Date).getTime()}function checkBaCodOrderCount(){var e=getBaCodCurrentTime();let t=localStorage.getItem("storedBaFirstOrderTime5Min"),a=parseInt(localStorage.getItem("storedBaOrderCount5Min"))||0,n=localStorage.getItem("storedBaFirstOrderTime12Hr"),d=parseInt(localStorage.getItem("storedBaOrderCount12Hr"))||0;return!t||3e5<e-parseInt(t)?(t=e,a=1):a++,localStorage.setItem("storedBaFirstOrderTime5Min",t.toString()),localStorage.setItem("storedBaOrderCount5Min",a.toString()),!n||432e5<e-parseInt(n)?(n=e,d=1):d++,localStorage.setItem("storedBaFirstOrderTime12Hr",n.toString()),localStorage.setItem("storedBaOrderCount12Hr",d.toString()),3<a||5<d}function baProcessOrder(t,a,n,d,o){fetch("https://lcrks.leanagri.com/third_parties/shopify_cod_app/api/v1/create-order/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>{201===e.status?e.json().then(e=>{sendBaCodGEvents("BA_cod_ordered",{from_frag:currentUrl1,order_value:a,ba_phone_number:d}),t.otp&&(sendBaCodGEvents("ba_cod_otp_success_and_ordered",{}),baCloseConfirmationModalAndReset()),"cod"===o?sendBaCodGEvents("ba_cod_ordered_cod",{}):"online"===o?sendBaCodGEvents("ba_cod_ordered_online",{}):"emi"===o&&sendBaCodGEvents("ba_cod_ordered_emi",{}),document.getElementById("baCodTriggerRecovery").disabled=!1,sendBaFbEvents("Purchase",{currency:"INR",value:a,num_items:n.length,payment_type:o}),sendBaCodGAConversionOrderedEvents(a,e.order.order_number,o);try{gtag("event","conversion",{send_to:"AW-682014322/--74CKG9_dcDEPLsmsUC",value:a,currency:"INR",transaction_id:""})}catch(e){}localStorage.setItem("BA_COD_FORM_NOTES_ATTRIBUTES",JSON.stringify(t.order.note_attributes)),baCodOrderUrl=e.order.order_status_url,baCodOrderNumber=e.order.order_number,document.getElementById("ba-cod-form-overlay-loader").style.display="block",baAuthenticateOrderPageUrlAndRoute()}):400===e.status?e.json().then(e=>{(e.error&&"Invalid OTP"===e.error?(sendBaCodGEvents("ba_cod_otp_invalid",{}),baOtpInvalidSetAndReset("block","1px solid #EC463B"),resetCodConfirmationModal):onBaOrderCreationError)()}):onBaOrderCreationError()}).catch(e=>{onBaOrderCreationError()})}function onBaOrderCreationError(){resetCodFooter(),document.getElementById("baCodTriggerRecovery").disabled=!1}function baScrollToId(e){document.getElementById(e).scrollIntoView({behavior:"smooth"})}function populatePriceDetailsCard(){var e=JSON.parse(localStorage.getItem("baUpdateCartResponse")),t=e.items,a=(replaceChildrenAlternative2(document.getElementById("ba-cod-price-details-content")),document.createElement("div"));a.id="ba-cod-price-details-items",document.getElementById("ba-cod-price-details-content").appendChild(a);for(let e=0;e<t.length;e++){var n=document.createElement("div"),d=(n.className="row mt-2 pb-2 align-items-center ba-cod-price-details-items",a.appendChild(n),document.createElement("div")),d=(d.className="col-7 ba-cod-price-details-product-title",d.innerHTML=mainPriceAmountLabel,n.appendChild(d),document.createElement("div"));d.className="col-5 text-right pl-0 ba-cod-price-details-product-price",d.id="ba-cod-product-price"+e,d.innerHTML=t[e].final_line_price?"₹ "+(Number(t[e].final_line_price)/100).toFixed(2):"0",n.appendChild(d)}var o=document.createElement("div"),l=(o.id="ba-free-delivery-div",o.className="row mt-2 pb-2 align-items-center ba-cod-price-details-items",o.style.display="none",document.getElementById("ba-cod-price-details-content").appendChild(o),document.createElement("div")),l=(l.className="col-7",l.innerHTML=priceDetailsFreeDeliveryLabel,o.appendChild(l),document.createElement("div")),o=(l.className="col-5 text-right pl-0 ba-cod-price-details-free-delivery",l.innerHTML=priceDetailsFreeDeliveryValueLabel,o.appendChild(l),document.createElement("div")),l=(o.id="ba-price-details-discount-row",o.className="row mt-2 pb-2 align-items-center ba-cod-price-details-discount",document.getElementById("ba-cod-price-details-content").appendChild(o),document.createElement("div")),l=(l.className="col-7",l.innerHTML=priceDetailsDiscountLabel,o.appendChild(l),document.createElement("div")),o=(l.className="col-5 text-right pl-0 ba-cod-price-details-total-discount",l.id="ba-price-details-discount-value",o.appendChild(l),document.createElement("div")),l=(o.id="ba-cod-price-details-bundle-items",document.getElementById("ba-cod-price-details-content").appendChild(o),document.createElement("div")),o=(l.id="ba-price-details-discount-total",l.className="row mt-3 pb-2 align-items-center ba-cod-price-details-total-amount",document.getElementById("ba-cod-price-details-content").appendChild(l),document.createElement("div")),o=(o.className="col-7",o.innerHTML=priceDetailsTotalAmountLabel,l.appendChild(o),document.createElement("div"));o.className="col-5 text-right pl-0 ba-cod-price-details-total-price",o.innerHTML="₹ "+(e.total_price/100).toFixed(2),o.id="ba-price-details-total-value",l.appendChild(o),document.getElementById("ba-cod-price-details-div").style.display="block",document.getElementById("ba-cod-footer-total-amount").innerHTML="₹ "+e.total_price/100,updateOnlinePaymentPrice(e.total_price/100)}function loadBlackListedPincodes(){fetch("https://shopify-krushidukan.leanagri.com/blacklisted_pincodes/en/pincodes/blacklisted.json",{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{blacklistedPincodes=e.data&&e.data.cod_blacklist||[]})}function replaceChildrenAlternative2(e){for(;e.firstChild;)e.removeChild(e.firstChild)}fetch("https://api-cache.leanagri.com/location/state_list/en/state/state_list.json",{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>{e.json().then(e=>{stateList=e.data,setStates()})}).catch(e=>{}),setInterval(()=>{var e=document.getElementById("farmerName"),t=document.getElementById("farmerMobile"),a=document.getElementById("baCodPincode"),n=document.getElementById("baCodStateSelect"),d=document.getElementById("baCodDistrictSelect"),o=(stateName,districtNameEn,document.getElementById("talukaName")),l=document.getElementById("villageName"),i=document.getElementById("baAddress"),r=document.getElementById("baLandmark");e.value=getFormattedAndRightValues(e.value),i.value=getFormattedAndRightValues(i.value),r.value=getFormattedAndRightValues(r.value),o.value=getFormattedAndRightValues(o.value),l.value=getFormattedAndRightValues(l.value),e.value&&2<e.value.length&&(e.classList.remove("ba-mandatory-field-border"),document.getElementById("farmerNameRequired").style.display="none"),t&&t.value&&10===t.value.length&&t.value.match(numericalNumberRegex)&&(t.classList.remove("ba-mandatory-field-border"),document.getElementById("farmerMobileRequired").style.display="none"),a&&a.value&&6===a.value.length&&a.value.match(numericalNumberRegex)&&"0"!==a.value[0]&&(document.getElementById("baCodPincodeRequired").style.display="none",0<getWhitelistedPincodes().length&&validateWhiteListedPincode(a.value)?(a.classList.remove("ba-mandatory-field-border"),document.getElementById("baCodPincodeNotWhitelistRequired").style.display="none"):checkAndRemovePincodeError(a)),stateId&&(n.classList.remove("ba-mandatory-field-border"),document.getElementById("baCodStateSelectRequired").style.display="none"),districtId&&(d.classList.remove("ba-mandatory-field-border"),document.getElementById("baCodDistrictSelectRequired").style.display="none"),o.value&&(o.classList.remove("ba-mandatory-field-border"),document.getElementById("talukaNameRequired").style.display="none"),l.value&&(l.classList.remove("ba-mandatory-field-border"),document.getElementById("villageNameRequired").style.display="none"),i.value&&2<i.value.length&&(i.classList.remove("ba-mandatory-field-border"),document.getElementById("baAddressRequired").style.display="none"),r.value&&(r.classList.remove("ba-mandatory-field-border"),document.getElementById("baLandmarkRequired").style.display="none")},2500),document.getElementById("baCodPincode").addEventListener("input",function(){6===this.value.length&&(document.getElementById("baCodPincodeServiceableRequired").style.display="none",document.getElementById("baCodPincodeNotWhitelistRequired").style.display="none",loadBaLocation(this.value),checkWhiteListedPincodes(this.value))});let options={key:"rzp_live_884X1cDEIdcCxd",currency:"INR",name:"BharatAgri",description:"BA Payment",order_id:"",handler:function(e){baPaymentHandler(e)},prefill:{name:"",email:"",contact:""},notes:{},theme:{color:"#009688"},modal:{ondismiss:function(){updatePaymentStatus(!1,"ba_payment_modal_close")}}};function checkFreeDelivery(){var e=getBaCodProductData(),t=sessionStorage.getItem("baCodVariantId")||1,a=document.getElementById("ba-free-delivery-div");e.variant_prices[t]&&e.variant_prices[t].show_free_delivery?a.style.display="flex":a.style.display="none"}function checkCodEligibility(e){var t=getBaCodProductData(),a=sessionStorage.getItem("baCodVariantId")||1,n=getBaCartMainItemDetails().product_id.toString();"cod"===e&&t.variant_prices[a]&&t.variant_prices[a].is_cod_enabled?(document.getElementById("ba-cod-place-btn-div").style.display="block",-1<baDisplayABTPrePaidProducts.indexOf(n)||baDisplayABTPrePaidSeconds<100||baRecoveryOnlineBtnEnable?(document.getElementById("ba-online-pay-main-div").style.display="block",sendBaCodGEvents("ba_ab_prepaid_btn",{value:n}),-1===baDisplayABTPrePaidProducts.indexOf(n)&&sendBaCodGEvents("ba_ab_prepaid_time_btn",{value:n})):(document.getElementById("ba-online-pay-main-div").style.display="none",sendBaCodGEvents("ba_ab_prepaid_no_display",{value:n}))):(document.getElementById("ba-cod-place-btn-div").style.display="none",document.getElementById("ba-online-pay-main-div").style.display="block")}function displayBaCodOnlinePayButton(e){var t=getBaCodProductData(),a=sessionStorage.getItem("baCodVariantId")||1,n=getBaCartMainItemDetails().product_id.toString();t.variant_prices[a]&&t.variant_prices[a].is_cod_enabled&&"cod"===baCheckoutType&&(-1<baDisplayABTPrePaidProducts.indexOf(n)||baDisplayABTPrePaidSeconds<100||baRecoveryOnlineBtnEnable?document.getElementById("ba-online-pay-main-div").style.display="block":document.getElementById("ba-online-pay-main-div").style.display=e)}function getMobileValue(){return document.getElementById("farmerMobile").value}function getLineItemsObject(){var t=JSON.parse(localStorage.getItem("baUpdateCartResponse")).items,a=[];for(let e=0;e<t.length;e++){var n={variant_id:t[e].variant_id,quantity:t[e].quantity,properties:{}};a.push(n)}return a}function getBaTotalOrderAmount(){var e=getBundlesActualTotalPriceWithoutDiscount(),t=(getBundlesTotalPrice(),JSON.parse(localStorage.getItem("baUpdateCartResponse")));return e+Number(t.total_price/100)}function getBaOrderObject(){var e,t,a=document.getElementById("farmerName"),n=document.getElementById("farmerMobile"),d=document.getElementById("baCodPincode"),o=(document.getElementById("baCodStateSelect"),getStateNameInEnglish()),l=districtNameEn,i=document.getElementById("talukaName"),r=document.getElementById("villageName"),c=document.getElementById("baAddress"),s=document.getElementById("baLandmark"),u=document.getElementById("baPostOffice"),m=a.value,b=n.value,p=d.value,y=o,g=l,i=i.value||"",r=r.value||"",v=c.value,s=s.value||"",u=u.value||"",a={name:a.value,mobile:n.value,pincode:d.value,state:o,district:l,taluka:i,village:r,stateId:stateId,districtId:districtId,talukaId:talukaId||"",villageId:villageId||"",address:c.value,landmark:s,postOffice:u,is_confirmation_popup:!1},B=[];for([e,t]of Object.entries(a)){var E={name:e,value:t};B.push(E)}let I=document.getElementById("ba-price-details-discount-value").innerHTML;I=I.replace("-₹ ","");n=getBundlesActualTotalPriceWithoutDiscount(),d=getBundlesTotalPrice(),o=JSON.parse(localStorage.getItem("baUpdateCartResponse")),Number(o.total_price/100),l=n-d;let C="";0<Number(I)&&(C=localStorage.getItem("BA_COD_Coupon_code"));var _,h=getLineItemsObject();for(let e=0;e<selectedBundles.length;e++)selectedBundles[e].enabled&&selectedBundles[e].selected&&(_={variant_id:selectedBundles[e].secondary_product.variant_id,quantity:1,properties:{is_bundled:"yes",bundle_price:selectedBundles[e].price}},h.push(_));i={order:{line_items:h,customer:{first_name:m},phone:"+91"+b,shipping_address:{first_name:m,last_name:"-",address1:v,phone:"+91"+b,city:g,province:y,country:"India",zip:p},billing_address:{first_name:m,last_name:"-",address1:v,phone:"+91"+b,city:g,province:y,country:"India",zip:p},financial_status:"pending",payment_gateway_names:["Cash on Delivery (COD)"],tags:"BharatAgri COD Form",note_attributes:B}};if(0<Number(I)||0<l){let e=C||"";0<l&&(e=e?e+", BA Custom Bundles Discount":"BA Custom Bundles Discount",B.push({name:"bundle_product_added",value:"yes"}),i.order.note_attributes=B);r=0<Number(I)?Number(I):0;r+=l,i.order.discount_codes=[{code:e,amount:r}]}return i}function getFormattedAndRightValues(t){if(t){let e=t.replace(/[^a-zA-Z0-9\u0900-\u097F .,]/g,"");return e=(e=e.replace(/\s+/g," ")).trim()}return t}function getStateNameInEnglish(){for(let e=0;e<stateList.length;e++)if(Number(stateId)===Number(stateList[e].id))return stateList[e].name_en}function baPaymentHandler(e){e&&e.razorpay_payment_id?(baRazorpayPaymentId=e.razorpay_payment_id,sendBaCodGEvents("ba_payment_razorpay_success",{value:getMobileValue()}),updatePaymentStatus(!0,"ba_payment_success")):updatePaymentStatus(!1,"ba_payment_failed")}function updatePaymentStatus(t,a){fetch(`https://lcrks.leanagri.com/third_parties/shopify/api/v1/update_order_status/?ref_id=${baRazorpayReferenceId}&payment_id=${baRazorpayPaymentId}&order_id=${baRazorpayOrderId}&status=`+t).then(e=>e.json()).then(e=>{sendMessage(a),(t?triggerOnlineOrderCreation:onOnlinePaymentFail)()}).catch(e=>{sendMessage(a),(t?triggerOnlineOrderCreation:onOnlinePaymentFail)()})}function triggerOnlineOrderCreation(){sendBaCodGEvents("ba_payment_success_trigger_order",{value:baRazorpayOrderId});var e=getMobileValue(),t=getBaOrderObject(),a=(t.order.financial_status="paid",t.order.payment_gateway_names=["Razorpay Secure"],t.order.discount_codes||[]),a=(t.order.discount_codes=getBaOnlineDiscountCodeObject(a),t.order.note_attributes.push({name:"order_id",value:baRazorpayOrderId}),t.order.note_attributes.push({name:"payment_id",value:baRazorpayPaymentId}),t.order.note_attributes.push({name:"online_amount",value:baRazorpayOnlineAmount}),getLineItemsObject());baCreateOrderApi(t,getBaTotalOrderAmount(),a,e,"online")}function triggerEmiOrderCreation(){sendBaCodGEvents("ba_payment_emi_success_trigger_order",{value:bharatxTransactionId});var e=getMobileValue(),t=getBaOrderObject(),a=(t.order.financial_status="paid",t.order.payment_gateway_names=["Razorpay Secure"],t.order.note_attributes.push({name:"order_id",value:bharatxTransactionId}),t.order.note_attributes.push({name:"bharatx_payment",value:"yes"}),t.order.note_attributes.push({name:"online_amount",value:baCodAmountFinal}),getLineItemsObject());baCreateOrderApi(t,getBaTotalOrderAmount(),a,e,"emi")}function sendMessage(e){sendBaCodGEvents(e,{value:baRazorpayOrderId})}function generateBaRazorpayOrder(t,e,a){var n=getBaOrderObject(),d=777*Number(e),o=n.order.discount_codes||[],o=(n.order.discount_codes=getBaOnlineDiscountCodeObject(o),{phone_number:t,cart_amount:e,order_details:n}),e=simpleJumble(o,t),n=new Headers;n.append("scc-ix-platform",d.toString()),n.append("content-type","application/json"),n.append("priorty",e),fetch("https://lcrks.leanagri.com/third_parties/shopify/api/v1/generate_order/",{method:"POST",headers:n,body:JSON.stringify(o)}).then(e=>e.json()).then(e=>{baRazorpayOrderId=e.order_id,baRazorpayReferenceId=e.reference_id,options.order_id=e.order_id,options.prefill.contact="+91"+t.toString(),options.prefill.email=t.toString()+"@bharatagri.com";e=new Razorpay(options);e.open(),e.on("payment.error",e=>{sendMessage("ba_payment_error"),onOnlinePaymentFail()}),e.on("payment.failed",e=>{updatePaymentStatus(!1,"ba_payment_failed")})}).catch(e=>{})}function onOnlinePaymentFail(){document.getElementById("baCodTriggerRecovery").disabled=!1,resetCodFooter()}function generateBaBharatxOrder(e,t,a){var n=getBaOrderObject(),d=969*Number(baCodAmountFinal),t=(t=(100*Number(t)).toFixed(0),t=Number(t),n.order.note_attributes.push({name:"bharatx_payment",value:"yes"}),{transaction:{amount:t,notes:{}},user:{name:a,phoneNumber:"+91"+e},createConfiguration:{successRedirectUrl:"https://app.bharatagri.com/bharatx-success?lang="+lang,failureRedirectUrl:"https://app.bharatagri.com/bharatx-failed?lang="+lang,cancelRedirectUrl:"https://app.bharatagri.com/bharatx-failed?lang="+lang}}),a={bharatx:t,ba_order:n},t=simple2Jumble(a,e),n=new Headers;n.append("scc-iz-platform",d.toString()),n.append("content-type","application/json"),n.append("prority",t),n.append("Extra-Auth","YmhhcmF0eGF1dGg="),fetch("https://lcrks.leanagri.com/payments/vendors/bharatx/api/v1/external_payment/",{method:"POST",headers:n,body:JSON.stringify(a)}).then(e=>e.json()).then(e=>{(e.transaction?(bharatxTransactionId=e.transaction.id,window.open(e.transaction.url),triggerBharatxStatus):onEmiPaymentFail)()}).catch(e=>{onEmiPaymentFail()})}function triggerBharatxStatus(){let t=setInterval(()=>{fetch(`https://shopify-krushidukan.leanagri.com/bharatx_payment/en/payments/${bharatxTransactionId}.json`,{method:"GET",redirect:"follow"}).then(e=>e.json()).then(e=>{clearInterval(t),(e.status?triggerEmiOrderCreation:onEmiPaymentFail)()}).catch(e=>{})},5e3)}function onEmiPaymentFail(){sendBaCodGEvents("ba_payment_emi_failed",{value:bharatxTransactionId}),document.getElementById("baCodTriggerRecovery").disabled=!1,resetCodFooter()}function openSmileyModal(){let e=document.getElementById("ba-cod-saved-amount").innerHTML;e=e.split("₹")[1];var t=localStorage.getItem("BA_COD_Coupon_code");document.getElementById("ba-smiley-modal-amt-id").innerHTML=`₹${e} `+smileyModalDiscountLabel,document.getElementById("ba-smiley-modal-coupon-id").innerHTML=t,document.getElementById("ba-smiley-modal-applied-id").innerHTML=smileyModalDiscountAppliedLabel,document.getElementById("ba-party-smiley-btn").click(),setTimeout(()=>{document.getElementById("ba-party-smiley-close").click()},4e3)}function getBaOnlineDiscountCodeObject(e){return 0<e.length?[{code:(e=e[0]).code+", BA Online Pay Discount",amount:Number(e.amount)+getOnlinePayDiscountAmount()}]:[{code:"ba_online_pay",amount:getOnlinePayDiscountAmount()}]}function getOnlinePayDiscountAmount(){var e=getBaCodProductData(),t=sessionStorage.getItem("baCodVariantId")||1;let a=.1;e.variant_prices[t]&&e.variant_prices[t].prepaid_discount_pc&&(a=Number(e.variant_prices[t].prepaid_discount_pc));e=getOnlyPriceWithoutTextValues(document.getElementById("ba-price-details-total-value").innerHTML);let n=Math.min(a*e,1e3);return n=(n=Math.floor(n))&&Number(n)&&!(Number(n)<40)?n:40}function getOnlinePayDiscountPercentage(){var e=getBaCodProductData(),t=sessionStorage.getItem("baCodVariantId")||1;let a=.1;return 100*(a=e.variant_prices[t]&&e.variant_prices[t].prepaid_discount_pc?Number(e.variant_prices[t].prepaid_discount_pc):a)}function getOnlyPriceWithoutTextValues(e){let t=e.replace("₹ ","");return(t=t.replace(".00",""))&&1<Number(t)?t:(e=e.match(/\d+(\.\d+)?/))?e[0]:0}function updateOnlinePaymentPrice(e){let t=Number(e);var a=getOnlinePayDiscountAmount();let n=Number(e)-a;-1!==e.toString().indexOf(".")&&(n=n.toFixed(2),t=t.toFixed(2)),baCodAmountFinal=t,baRazorpayOnlineAmount=n,document.getElementById("ba-cod-footer-online-original-amount").innerHTML="₹ "+t,document.getElementById("ba-cod-footer-online-amount").innerHTML="₹ "+n,document.getElementById("baCodFooterOnlineDiscount").innerHTML=`₹${a} `+baOnlinePaymentDiscountLabel,document.getElementById("ba-cod-footer-online-original-emi-amount").style.display="none",document.getElementById("ba-cod-footer-online-emi-amount").innerHTML="₹ "+t,document.getElementById("baCodFooterOnlineEmiDiscount").innerHTML=""+baOnlinePaymentDiscountEmiLabel}function getOnlinePaymentPrice(){var e=baRazorpayOnlineAmount.toString();let t=e;return(t=(t=t.replace("₹ ","")).replace(".00",""))&&1<Number(t)?t:(e=e.match(/\d+(\.\d+)?/))?e[0]:0}function getOnlineEmiPaymentPrice(){var e=baCodAmountFinal.toString();let t=e;return(t=(t=t.replace("₹ ","")).replace(".00",""))&&1<Number(t)?t:(e=e.match(/\d+(\.\d+)?/))?e[0]:0}let updateBaCartApiCaller=createUpdateBaCartApiCaller();function incrementQuantity(){var e=document.getElementById("ba-cod-quantity"),t=Number(e.value);t<10&&(e.value=t+1,updateBaCartApiCaller("add",t+1))}function decrementQuantity(){var e=document.getElementById("ba-cod-quantity"),t=Number(e.value);1<t&&(e.value=t-1,updateBaCartApiCaller("remove",t-1))}function createUpdateBaCartApiCaller(){let a;return function(e,t){a=t,clearTimeout(this.timeout),this.timeout=setTimeout(()=>{updateBaCart(e,t)},500)}}function updateBaCart(e,n){(1<=n||"add"===e)&&((e={})[JSON.parse(localStorage.getItem("baUpdateCartResponse")).items[0].variant_id]=n,fetch("/cart/update.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({updates:e})}).then(e=>e.json()).then(e=>{localStorage.setItem("baUpdateCartResponse",JSON.stringify(e));var t=getBundlesTotalPrice(),a=Number(e.total_price/100),e=Number(e.total_price/100);e+=t,document.getElementById("ba-price-details-total-value").innerHTML="₹ "+e.toFixed(2),document.getElementById("ba-cod-footer-total-amount").innerHTML="₹ "+e.toFixed(2),updateOnlinePaymentPrice(e.toFixed(2)),document.getElementById("ba-cod-main-product-price0").innerHTML="₹ "+a,document.getElementById("ba-cod-product-price0").innerHTML="₹ "+a.toFixed(2),document.getElementById("ba-cod-main-product-quantity0").innerHTML=n,baRecoveryApplied&&applyBaRecoveryDiscount(!1),loadCouponCodes(!1)}))}function simpleJumble(e,t){t+=`-${getOnlinePaymentPrice()}-uqfKjsRrHg`,e=CryptoJS.HmacSHA256(JSON.stringify(e),t);return CryptoJS.enc.Base64.stringify(e)}function simple2Jumble(e,t){var a=getOnlineEmiPaymentPrice(),a=(100*Number(a)).toFixed(0),t=(t="+91"+t)+`-${Number(a)}-2MvybzaKEM`,a=CryptoJS.HmacSHA256(JSON.stringify(e),t);return CryptoJS.enc.Base64.stringify(a)}function autoFillUserDetails(){var e=JSON.parse(localStorage.getItem("BA_COD_FORM_NOTES_ATTRIBUTES"))||[];e.forEach(e=>{"name"===e.name&&(document.getElementById("farmerName").value=e.value),"mobile"===e.name&&(sendBaCodGEvents("ba_cod_auto_address",{ba_phone_number:e.value}),document.getElementById("farmerMobile").value=e.value),"stateId"===e.name&&(document.getElementById("baCodStateSelect").value=e.value,stateId=e.value),"state"===e.name&&(stateName=e.value,stateNameEn=e.value),"districtId"===e.name&&(document.getElementById("baCodDistrictSelect").value=e.value,districtId=e.value),"district"===e.name&&(districtName=e.value,districtNameEn=e.value),"talukaId"===e.name&&(talukaId=e.value||""),"taluka"===e.name&&(document.getElementById("talukaName").value=e.value,talukaName=e.value,talukaNameEn=e.value),"villageId"===e.name&&(villageId=e.value||""),"village"===e.name&&(document.getElementById("villageName").value=e.value,villageName=e.value,villageNameEn=e.value),"address"===e.name&&(document.getElementById("baAddress").value=e.value),"landmark"===e.name&&(document.getElementById("baLandmark").value=e.value),"pincode"===e.name&&(document.getElementById("baCodPincode").value=e.value)}),stateId&&loadDistricts(stateId,districtId||"",districtNameEn||""),districtId&&loadTalukas(districtId,talukaId||"",talukaNameEn||""),talukaId&&loadVillages(talukaId,villageId||"",villageNameEn||""),0===e.length&&setBaIpOrGpsLocation(JSON.parse(sessionStorage.getItem("ba_ip_location_details"))||{},!1)}function setBaIpOrGpsLocation(e,t){t&&(document.getElementById("baCodLocateMeIconLoader").style.display="none",document.getElementById("baCodLocateMeIcon").style.display="block"),e.state&&(document.getElementById("baCodStateSelect").value=e.state,stateId=e.state),e.state_name&&(stateName=e.state_name,stateNameEn=e.state_name),e.district&&(document.getElementById("baCodDistrictSelect").value=e.district,districtId=e.district),e.district_name&&(districtName=e.district_name,districtNameEn=e.district_name),e.taluka&&(talukaId=e.taluka||""),e.taluka_name&&(document.getElementById("talukaName").value=e.taluka_name,talukaName=e.taluka_name,talukaNameEn=e.taluka_name),e.village&&(villageId=e.village||""),e.village_name&&(document.getElementById("villageName").value=e.village_name,villageName=e.village_name,villageNameEn=e.village_name),e.pin_code&&(document.getElementById("baCodPincode").value=e.pin_code,sendBaCodGEvents(t?"ba_address_populated_gps":"ba_address_populated_ip",{value:e.pin_code})),stateId&&loadDistricts(stateId,districtId||"",districtNameEn||""),districtId&&loadTalukas(districtId,talukaId||"",talukaNameEn||""),talukaId&&loadVillages(talukaId,villageId||"",villageNameEn||"")}function getBaGPSLocation(){sendBaCodGEvents("ba_address_populated_gps_btn_clk",{}),document.getElementById("baCodLocateMeIconLoader").style.display="inline-block",document.getElementById("baCodLocateMeIcon").style.display="none";var e=JSON.parse(sessionStorage.getItem("ba_gps_location_details"))||{};if(e.state)setBaIpOrGpsLocation(e,!0);else try{getBaLocationFromGPS().then(e=>{setBaIpOrGpsLocation(e||{},!0)})}catch(e){}}function resetPlaceOrderButton(){document.getElementById("ba-cod-place-btn").setAttribute("style","display:flex !important"),displayBaCodOnlinePayButton("none")}function resetCodFooter(){document.getElementById("ba-cod-create-order-button").disabled=!1,document.getElementById("ba-cod-create-order-online-button").disabled=!1,document.getElementById("ba-cod-create-order-online-emi-button").disabled=!1,document.getElementById("ba-cod-footer-total-amount").style.display="block",document.getElementById("ba-cod-footer-apply-btn-loader").style.display="none",document.getElementById("ba-cod-footer-online-amount").style.display="block",document.getElementById("ba-cod-footer-online-btn-loader").style.display="none",document.getElementById("ba-cod-footer-online-emi-amount").style.display="block",document.getElementById("ba-cod-footer-online-btn-emi-loader").style.display="none"}function resetCodConfirmationModal(){document.getElementById("ba-cod-confirm-no-btn-loader").style.display="none",document.getElementById("ba-cod-confirm-yes-btn-loader").style.display="none",document.getElementById("ba-cod-confirm-no-btn").disabled=!1,document.getElementById("ba-cod-confirm-yes-btn").disabled=!1,document.getElementById("baCodTriggerRecovery").disabled=!1,document.getElementById("ba-cod-otp-submit-btn-loader").style.display="none",document.getElementById("baCodOtpSubmitBtn").disabled=!1,document.getElementById("baCodOtpCancelBtn").disabled=!1}function resetCodFormFields(){resetLocationFields(),document.getElementById("farmerName").value="",document.getElementById("farmerMobile").value="",document.getElementById("baCodPincode").value="",document.getElementById("baAddress").value="",document.getElementById("baLandmark").value="",document.getElementById("baPostOffice").value="",highRiskProductFlag=!1,otpVerifyFlag=!1,baCodOrderUrl="",baCodOrderNumber="",baOnlinePaySuccess=!1,baRazorpayOrderId="",baRazorpayPaymentId="",baRazorpayReferenceId="",bharatxTransactionId="",baOtpCountdown="",baRazorpayOnlineAmount="",baCodAmountFinal="",resetFormFieldsValidation()}function resetLocationFields(){stateId="",districtId="",talukaId="",villageId="",stateName="",stateNameEn="",districtName="",districtNameEn="",talukaName="",talukaNameEn="",villageName="",villageNameEn="",document.getElementById("baCodLocateMeIconLoader").style.display="none",document.getElementById("baCodLocateMeIcon").style.display="block",document.getElementById("baCodStateSelect").value="",document.getElementById("baCodDistrictSelect").value="",resetTalukaAndVillage()}function resetTalukaAndVillage(){document.getElementById("talukaName").value="",document.getElementById("villageName").value=""}function resetFormFieldsValidation(){document.getElementById("farmerName").classList.remove("ba-mandatory-field-border"),document.getElementById("farmerMobile").classList.remove("ba-mandatory-field-border"),document.getElementById("baCodPincode").classList.remove("ba-mandatory-field-border"),document.getElementById("baCodStateSelect").classList.remove("ba-mandatory-field-border"),document.getElementById("baCodDistrictSelect").classList.remove("ba-mandatory-field-border"),document.getElementById("talukaName").classList.remove("ba-mandatory-field-border"),document.getElementById("villageName").classList.remove("ba-mandatory-field-border"),document.getElementById("baAddress").classList.remove("ba-mandatory-field-border"),document.getElementById("baLandmark").classList.remove("ba-mandatory-field-border"),document.getElementById("farmerNameRequired").style.display="none",document.getElementById("farmerMobileRequired").style.display="none",document.getElementById("baCodPincodeRequired").style.display="none",document.getElementById("baCodPincodeServiceableRequired").style.display="none",document.getElementById("baCodPincodeNotWhitelistRequired").style.display="none",document.getElementById("baCodStateSelectRequired").style.display="none",document.getElementById("baCodDistrictSelectRequired").style.display="none",document.getElementById("talukaNameRequired").style.display="none",document.getElementById("villageNameRequired").style.display="none",document.getElementById("baAddressRequired").style.display="none",document.getElementById("baLandmarkRequired").style.display="none"}function resetDistrictValues(){districtId="",districtNameEn="",districtName=""}function resetTalukaValues(){talukaId="",talukaNameEn="",talukaName=""}function resetVillageValues(){villageId="",villageNameEn="",villageName=""}function onSelectBoxStateChange(e){stateName=e.options[e.selectedIndex].text,stateNameEn=e.options[e.selectedIndex].text,stateId=e.options[e.selectedIndex].value,resetDistrictValues(),resetTalukaValues(),resetVillageValues(),loadDistricts(stateId)}function onSelectBoxDistrictChange(e){districtName=e.options[e.selectedIndex].text,districtNameEn=e.options[e.selectedIndex].text,districtId=e.options[e.selectedIndex].value,resetTalukaValues(),resetVillageValues(),loadTalukas(districtId)}function setStateFromPincode(e,t,a,n,d){document.getElementById("baCodStateSelect").value=e,stateName=t,stateNameEn=a,stateId=e}function setDistrictFromPincode(e,t,a,n){districtName=t,districtNameEn=a,loadDistricts(n,districtId=e,t)}function setTalukaFromPincode(e,t,a,n){talukaName=t,talukaNameEn=a,talukaId=e,document.getElementById("talukaName").value=a,loadTalukas(n,e,t)}function setVillageFromPincode(e,t,a,n){villageName=t,villageNameEn=a,villageId=e,document.getElementById("villageName").value=a,loadVillages(n,e,t)}function onInputElementClick(e){"taluka"===e&&baScrollToId("talukaName"),"village"===e&&baScrollToId("villageName");var t=document.getElementById("farmerMobile").value;if(t&&10===t.length&&sendBaCodGEvents("BA_cart_phn",{from_frag:currentUrl1,ba_field_name:e,ba_phone_number:t}),"name"===e||"mobile"===e){let e=document.getElementById("ba-price-details-total-value").innerHTML;e=e.replace("₹ ",""),sendBaFbEvents("AddPaymentInfo",{currency:"INR",value:Number(e)})}sendBaCodGEvents("BA_address_clk",{from_frag:currentUrl1,ba_field_name:e})}function sendBaCodGEvents(e,t){try{gtag("event",e,t)}catch(e){}}function triggerBaCodConversionEvents(){sendBaCodGAConversionEvents("add_to_cart"),sendBaCodGAConversionEvents("begin_checkout"),sendBaCodShopifyAnalyticsEvents("Added to Cart","",""),sendBaCodShopifyAnalyticsEvents("Checkout Started","","")}function sendBaCodGAConversionEvents(e){var t=getBaCartMainItemDetails(),a=t.final_line_price/100;try{gtag("event",e,{currency:"INR",value:a,items:[{item_id:t.id,item_name:t.title,quantity:t.quantity,price:a}]})}catch(e){}}function sendBaCodGAConversionOrderedEvents(e,t,a){var n=getBaCartMainItemDetails(),d=n.final_line_price/100;try{gtag("event","purchase",{transaction_id:t,value:e,currency:"INR",items:[{item_id:n.id,item_name:n.title,quantity:n.quantity,price:d}],payment_type:a}),sendBaCodShopifyAnalyticsEvents("Purchase",e,t)}catch(e){}}function sendBaCodShopifyAnalyticsEvents(t,a,n){var d=getBaCartMainItemDetails(),o=d.final_line_price/100;try{let e="Purchase"===t?{order_number:n,total_price:a,items:[{id:d.id,name:d.title,price:o,quantity:d.quantity}]}:"Checkout Started"===t?{cart_total:o,items:[{id:d.id,name:d.title,price:o,quantity:d.quantity}]}:"Added to Cart"===t?{id:d.id,name:d.title,price:o,quantity:d.quantity}:{};ShopifyAnalytics.lib.track(t,e)}catch(e){}}function sendBaFbEvents(e,t){var a=getBaCartMainItemDetails();try{t.content_ids=[a.id],t.content_name=a.title,t.content_type="product_group",fbq("track",e,t)}catch(e){}}function loadBaLocation(e){6===e.length&&fetch(`https://shopify-krushidukan.leanagri.com/pincode_mapping/en/pincode/${e}/pincode.json`).then(e=>{200===e.status&&e.json().then(e=>{e.data&&setPincodeLocation(e.data)})}).catch(e=>{})}function setPincodeLocation(n){resetLocationFields();let d="name_"+lang;try{["state","district","taluka","village"].forEach(e=>{var t,a=n[e];a&&(t=a[d]||a.name,"state"===e?setStateFromPincode(a.id,t,a.name_en):"district"===e?setDistrictFromPincode(a.id,t,a.name_en,n.state.id):"taluka"===e?setTalukaFromPincode(a.id,t,a.name_en,n.district.id):setVillageFromPincode(a.id,t,a.name_en,n.taluka.id))})}catch(e){}}function checkPincodeServiceability(e){-1<String(blacklistedPincodes).indexOf(e)?(document.getElementById("ba-cod-place-btn").setAttribute("style","display:none !important"),displayBaCodOnlinePayButton("block"),document.getElementById("baCodPincode").classList.add("ba-mandatory-field-border"),document.getElementById("baCodPincodeServiceableRequired").style.display="block",sendBaCodGEvents("ba_cod_pincode_error",{pincode:e})):(displayBaCodOnlinePayButton("none"),document.getElementById("ba-cod-place-btn").setAttribute("style","display:flex !important"))}function checkWhiteListedPincodes(e){var t=getWhitelistedPincodes();!(0<t.length)||-1<String(t).indexOf(e)?checkPincodeServiceability(e):(document.getElementById("baCodPincode").classList.add("ba-mandatory-field-border"),document.getElementById("baCodPincodeNotWhitelistRequired").innerHTML=pincodeNotWhitelistRequiredLabel.replace("pincode",e),document.getElementById("baCodPincodeNotWhitelistRequired").style.display="block",sendBaCodGEvents("ba_cod_pincode_error",{pincode:e}))}function validateWhiteListedPincode(e){var t=getWhitelistedPincodes();return-1<String(t).indexOf(e)}function displayPincodeError(e){document.getElementById("ba-cod-place-btn").setAttribute("style","display:none !important"),displayBaCodOnlinePayButton("block"),e.classList.add("ba-mandatory-field-border"),document.getElementById("baCodPincodeServiceableRequired").style.display="block",sendBaCodGEvents("ba_cod_pincode_error",{pincode:e.value})}function checkAndRemovePincodeError(e){-1===String(blacklistedPincodes).indexOf(e.value)&&(displayBaCodOnlinePayButton("none"),document.getElementById("ba-cod-place-btn").setAttribute("style","display:flex !important"),e.classList.remove("ba-mandatory-field-border"),document.getElementById("baCodPincodeServiceableRequired").style.display="none")}function baFormValidationErrorRest(){document.getElementById("baCodTriggerRecovery").disabled=!1,document.getElementById("ba-cod-create-order-button").disabled=!1,document.getElementById("ba-cod-create-order-online-button").disabled=!1,document.getElementById("ba-cod-create-order-online-emi-button").disabled=!1,sendBaCodGEvents("ba_cod_order_validate_error",{field:"addressFields"})}function getBaCodProductData(){return JSON.parse(sessionStorage.getItem("baCodProductData"))||{}}function getWhitelistedPincodes(){return getBaCodProductData().pincode_whitelist||[]}function displayBaRecoveryDiscount(){let e=document.getElementById("ba-price-details-discount-value").innerHTML;e=e.replace("-₹ ","");var t=getOnlinePayDiscountPercentage();document.getElementById("baOffer5Percent").innerHTML=t+"%",document.getElementById("baRecoveryOrderNow").innerHTML=baRecoveryOrderNow.replace("###",t),(baRecoveryOrder&&!baRecoveryOnlineBtnEnable?document.getElementById("ba-cod-recovery-discount-btn"):document.getElementById("baCodFormClose")).click()}function applyBaRecoveryDiscount(e){baRecoveryOnlineBtnEnable=!0,document.getElementById("ba-online-pay-main-div").style.display="block",e&&(document.getElementById("baRecoveryClose").click(),sendBaCodGEvents("ba_cod_recovery_display_online_btn",{}))}function closeBaRecoveryDiscountAndForm(){baRecoveryOrder=!1,document.getElementById("baCodFormClose").click(),document.getElementById("baRecoveryClose").click(),sendBaCodGEvents("ba_cod_order_recovery_cancel",{})}function getBaCartMainItemDetails(){return JSON.parse(localStorage.getItem("baUpdateCartResponse")).items[0]}function replaceChildrenAlternative(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function checkHighRiskAndOTPVerifyOrder(){var e=JSON.parse(localStorage.getItem("baUpdateCartResponse")).items[0].id,t=(highRiskProducts=[],otpVerifyProducts=[],getBaCodProductData());(highRiskProducts=t.verification_popup_variants&&0<t.verification_popup_variants.length?t.verification_popup_variants:highRiskProducts)&&-1<highRiskProducts.indexOf(String(e))&&(highRiskProductFlag=!0),(otpVerifyProducts=t.otp_verification_variants&&0<t.otp_verification_variants.length?t.otp_verification_variants:otpVerifyProducts)&&-1<otpVerifyProducts.indexOf(String(e))&&(otpVerifyFlag=!0)}function displayConfirmationModal(e){let t=document.getElementById("ba-price-details-total-value").innerHTML;t=t.replace("₹ ",""),t=(t=Number(t).toFixed(2)).replace(".00",""),document.getElementById("ba-cod-confirm-txt-div").innerHTML=confirmModalTextLabel.replace("###",t),document.getElementById("ba-cod-otp-header").innerHTML=baCodOtpHeaderLabel.replace("###",t);var a=document.getElementById("farmerMobile").value,a=(document.getElementById("ba-cod-otp-instructions").innerHTML=baCodOtpInstructionsLabel.replace("###",a),document.getElementById("ba-confirmation-modal-div")),n=document.getElementById("ba-confirmation-otp-div");baResetOtpValues(),otpVerifyFlag||e?(n.style.display="block",a.style.display="none",onDisplayBaCodOTPModal()):highRiskProductFlag&&(n.style.display="none",a.style.display="block"),document.getElementById("ba-confirmation-btn").click()}function onBaConfirmationModalYes(){var e=JSON.parse(localStorage.getItem("baProcessOrder"));document.getElementById("ba-cod-confirm-no-btn").disabled=!0,document.getElementById("ba-cod-confirm-yes-btn").disabled=!0,document.getElementById("ba-cod-confirm-yes-btn-loader").style.display="inline-block",document.getElementById("ba-confirmation-close").click(),resetCodConfirmationModal(),baProcessOrder(e.baO2,e.createOrderTotalValue,e.createOrderLineItems,e.mobileValue,e.type)}function onBaConfirmationModalNo(){document.getElementById("ba-cod-confirm-no-btn").disabled=!0,document.getElementById("ba-cod-confirm-yes-btn").disabled=!0,document.getElementById("ba-cod-confirm-no-btn-loader").style.display="inline-block",document.getElementById("ba-confirmation-close").click(),resetCodFooter(),resetCodConfirmationModal()}function onBaOTPModalCancel(){sendBaCodGEvents("ba_cod_otp_cancel_btn",{}),document.getElementById("ba-confirmation-close").click(),baClearOtpCountdownInterval(),resetCodFooter(),resetCodConfirmationModal()}function onBaOTPModalSubmit(){var e;baOtpNumberValidation()&&(sendBaCodGEvents("ba_cod_otp_submit_btn",{}),baOtpInvalidSetAndReset("none","1px solid #ccc"),e=JSON.parse(localStorage.getItem("baProcessOrder")),document.getElementById("baCodOtpSubmitBtn").disabled=!0,document.getElementById("baCodOtpCancelBtn").disabled=!0,document.getElementById("ba-cod-otp-submit-btn-loader").style.display="inline-block",e.baO2.otp={phone:getBaMobileValueWithFormat(),otp:getBaOtpEnteredValue()},baProcessOrder(e.baO2,e.createOrderTotalValue,e.createOrderLineItems,e.mobileValue,e.type))}function baOtpNumberValidation(){var e=document.querySelectorAll(".ba-cod-otp");return e[0].value.match(numericalNumberRegex)&&e[1].value.match(numericalNumberRegex)&&e[2].value.match(numericalNumberRegex)&&e[3].value.match(numericalNumberRegex)}function getBaOtpEnteredValue(){var e=document.querySelectorAll(".ba-cod-otp");return String(e[0].value)+String(e[1].value)+String(e[2].value)+String(e[3].value)}function baCloseConfirmationModalAndReset(){baClearOtpCountdownInterval(),document.getElementById("ba-confirmation-close").click(),resetCodConfirmationModal()}function baClearOtpCountdownInterval(){baOtpCountdown&&clearInterval(baOtpCountdown)}function baOtpInvalidSetAndReset(e,a){document.getElementById("baCodOtpInvalid").style.display=e,document.querySelectorAll(".ba-cod-otp").forEach((e,t)=>{e.style.border=a})}function baResetOtpValues(){document.getElementById("baCodOtpInvalid").style.display="none",document.querySelectorAll(".ba-cod-otp").forEach((e,t)=>{e.value="",e.style.border="1px solid #ccc"})}function startOtpTimer(){let t=29,a=document.getElementById("baCodOtpTimer"),n=document.getElementById("baCodResendOtpBtn");n.disabled=!0,n.style.border="1px solid #ADB2C0",n.style.color="#ADB2C0",baClearOtpCountdownInterval(),baOtpCountdown=setInterval(()=>{var e;t<=0?(clearInterval(baOtpCountdown),a.textContent="00:00",n.disabled=!1,n.style.border="1px solid #0A8047",n.style.color="#0A8047"):(e=t%60,a.textContent="00:"+(e<10?"0":"")+e,t--)},1e3)}function onDisplayBaCodOTPModal(){sendBaCodGEvents("ba_cod_otp_display_modal",{}),sendBaCodOtp(),startOtpTimer();let n=document.querySelectorAll(".ba-cod-otp");n.forEach((t,a)=>{t.addEventListener("input",()=>{1===t.value.length&&(a<n.length-1&&n[a+1].focus(),sendBaCodGEvents("ba_cod_otp_enter_input",{}))}),t.addEventListener("keydown",e=>{"Backspace"===e.key&&0===t.value.length&&0<a&&n[a-1].focus()})})}function onBaCodResendOtp(){sendBaCodGEvents("ba_cod_otp_resend_btn",{}),baOtpInvalidSetAndReset("none","1px solid #ccc"),baResetOtpValues(),sendBaCodOtp(),startOtpTimer()}function sendBaCodOtp(){var e=new Headers,e=(e.append("UnxsUBYk","OerRvTJlrQLc0A=="),{method:"GET",redirect:"follow",headers:e}),t=getBaMobileValueTenDigits();sendBaCodGEvents("ba_cod_otp_sent",{value:t.toString()}),fetch("https://lcrks.leanagri.com/api/v2/web/getOtp/?phone_number="+t,e).then(e=>e.json()).then(e=>{}).catch(e=>{})}function getBaMobileValueWithFormat(){return"+91"+document.getElementById("farmerMobile").value}function getBaMobileValueTenDigits(){return document.getElementById("farmerMobile").value}function setBaAssistDropdownOptions(e,t,n,a){let d=document.getElementById(t),o=(d.innerHTML="",[]);e.forEach(function(e){let t=e.name_en||"";var a;-1===o.indexOf(t.toLowerCase())&&((a=document.createElement("span")).textContent=t,a.onclick=function(){document.getElementById(n).value=t,d.classList.remove("ba-assist-show"),"talukaName"===n&&(resetVillageValues(),loadVillages(e.id))},d.appendChild(a),o.push(t.toLowerCase()))}),a||(document.getElementById(n).value="")}function baFilterDropdownFunction(e,t){for(var a=document.getElementById(e).value.toUpperCase(),e=document.getElementById(t),n=e.getElementsByTagName("span"),d=0;d<n.length;d++)-1<(n[d].textContent||n[d].innerText).toUpperCase().indexOf(a)?n[d].style.display="":n[d].style.display="none";e.classList.add("ba-assist-show")}function onConfirmationModalClick(e){}function loadProductBundlesOldFunction(){fetch(`https://lcrks.leanagri.com/third_parties/shopify_cod_app/api/v1/cod-bundles/?variant_id=${bundleVariant}&lang=`+lang,{method:"GET",redirect:"follow"}).then(e=>{200===e.status?e.json().then(e=>{e&&e.data?setBaProductBundles(e.data):document.getElementById("ba-cod-bundle-div").style.display="none"}):document.getElementById("ba-cod-bundle-div").style.display="none"}).catch(e=>{document.getElementById("ba-cod-bundle-div").style.display="none"})}function baAuthenticateOrderPageUrlAndRoute(){var e=`phone=${document.getElementById("farmerMobile").value}&order_number=`+baCodOrderNumber;fetch(baCodOrderUrl,{headers:{"content-type":"application/x-www-form-urlencoded","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrerPolicy:"strict-origin-when-cross-origin",body:e.toString(),method:"POST",mode:"cors",credentials:"include"}).then(e=>{var t=baCodOrderUrl.split("/authenticate")[0];window.open(t,"_self")})}function calculateBaCodDeliveryDates(){var e=new Date,e=e.setDate(e.getDate()+4);getBaCodDeliveryFormatDate(new Date(e))}function getBaCodDeliveryFormatDate(e){e=new Date(e);var t=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"),a=new Array("रविवार","सोमवार","मंगलवार","बुधवार","गुरुवार","शुक्रवार","शनिवार"),n=new Array("रविवार","सोमवार","मंगळवार","बुधवार","गुरुवारी","शुक्रवार","शनिवार");let d="",o="",l=window.location.href;-1<(l=l.toString()).indexOf(".com/en")?(d=t[e.getDay()],o=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()],document.getElementById("ba-cod-delivery-days-label").innerHTML=" FREE Delivery"):-1<l.indexOf(".com/mr")?(d=n[e.getDay()],o=["जानेवारी","फेब्रुवारी","मार्च","एप्रिल","मे","जून","जुलै","ऑगस्ट","सप्टेंबर","ऑक्टोबर","नोव्हेंबर","डिसेंबर"][e.getMonth()],document.getElementById("ba-cod-delivery-days-label").innerHTML=" फ्री डिलिव्हरी"):(d=a[e.getDay()],o=["जनवरी","फरवरी","मार्च","अप्रैल","मई","जून","जुलाई","अगस्त","सितम्बर","अक्टूबर","नवम्बर","दिसम्बर"][e.getMonth()],document.getElementById("ba-cod-delivery-days-label").innerHTML=" फ्री डिलीवरी"),document.getElementById("ba-cod-delivery-date").innerHTML=d+", "+e.getDate()+" "+o}function applyCouponCodes_OLDFunction(t,e,a,n){document.getElementById("ba-cod-discount-loader").style.display="block",previousCouponCode=previousCouponCode||t;var d=document.querySelector("script[id='shopify-features']"),d=JSON.parse(d.innerHTML),o=JSON.parse(localStorage.getItem("baUpdateCartResponse")),l=o.items,i=[];document.getElementById("ba-price-details-discount-value").innerHTML="0",document.getElementById("ba-price-details-discount-row").style.display="none";let r=getBundlesTotalPrice();var c=Number(o.total_price/100),o=Number(o.total_price/100),o=(o+=r,sendBaCodGEvents("BA_cart_cc_clk",{from_frag:currentUrl1,discount_coupon:t,order_value:c}),document.getElementById("ba-price-details-total-value").innerHTML="₹ "+o.toFixed(2),document.getElementById("ba-cod-footer-total-amount").innerHTML="₹ "+o.toFixed(2),updateOnlinePaymentPrice(o.toFixed(2)),previousCouponCode&&(c=document.getElementById(previousCouponCode))&&(c.style.display="block"),document.getElementById("ba-active-coupon"));o&&(o.style.display="none");for(let e=0;e<l.length;e++){var s={variant_id:l[e].variant_id,quantity:l[e].quantity,properties:{}};i.push(s)}c={checkout:{discount_code:t,line_items:i,presentment_currency:"INR"}};fetch("/wallets/checkouts/",{method:"POST",headers:{"Content-Type":"application/json",authorization:"Basic "+btoa(d.accessToken)},body:JSON.stringify(c)}).then(e=>{201===e.status?e.json().then(e=>{e.checkout.applied_discount.applicable?(document.getElementById(t).style.display="none",document.getElementById("ba-active-coupon").style.display="block",document.getElementById("ba-cod-saved-amount").innerHTML=couponSavedLabel+" ₹"+e.checkout.total_discount_amount.replace(".00",""),document.getElementById("ba-cod-saved-amount-line2").innerHTML=couponWithDiscountLabel,document.getElementById("ba-cod-applied-coupon-content").innerHTML=t+" "+couponAppliedLabel,document.getElementById("ba-price-details-discount-value").innerHTML="-₹ "+e.checkout.total_discount_amount.replace(".00",""),r=getBundlesTotalPrice(),e=Number(e.checkout.total_price.replace(".00","")),e+=r,document.getElementById("ba-price-details-total-value").innerHTML="₹ "+e.toFixed(2),document.getElementById("ba-cod-footer-total-amount").innerHTML="₹ "+e.toFixed(2),updateOnlinePaymentPrice(e.toFixed(2)),document.getElementById("ba-price-details-discount-row").style.display="flex",previousCouponCode=t,document.getElementById("ba-cod-discount-loader").style.display="none",a&&document.getElementById("ba-active-coupon").scrollIntoView({behavior:"smooth"}),localStorage.setItem("BA_COD_Coupon_code",t),baRecoveryApplied=!1):(document.getElementById("ba-cod-discount-loader").style.display="none",localStorage.removeItem("BA_COD_Coupon_code"))}):(document.getElementById("ba-cod-discount-loader").style.display="none",localStorage.removeItem("BA_COD_Coupon_code"))}).catch(e=>{document.getElementById("ba-cod-discount-loader").style.display="none",localStorage.removeItem("BA_COD_Coupon_code")})}document.addEventListener("click",function(e){var t=document.getElementById("baCodTalukaDropdown"),a=document.getElementById("talukaName"),n=document.getElementById("baCodVillageDropdown"),d=document.getElementById("villageName");e.target===a||a.contains(e.target)||t.classList.remove("ba-assist-show"),e.target===d||d.contains(e.target)||n.classList.remove("ba-assist-show")}),calculateBaCodDeliveryDates();